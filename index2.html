<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ubungo Municipal Web Atlas</title>

<!-- Cesium Globe -->
<link href="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
<script src="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Cesium.js"></script>

<!-- Leaflet Maps -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
html, body { margin:0; height:100%; font-family:"Inter",sans-serif; background:#111; color:#fff; }
.section { display:none; height:100vh; width:100vw; }
.active { display:block; }

/* HOME / GLOBE */
#globe { height:100%; width:100%; }
.home-overlay {
  position:absolute; top:20%; left:5%; width:420px;
  background:rgba(0,0,0,0.65); color:white; padding:30px;
  border-radius:15px; box-shadow:0 0 20px rgba(0,0,0,0.8);
}
.home-overlay h1 { margin-top:0; font-size:28px; }
.home-overlay p { font-size:16px; line-height:1.4; }
.home-btn {
  display:flex; align-items:center; justify-content:center;
  margin-top:15px; padding:12px;
  background:#1abc9c; color:white; text-align:center;
  text-decoration:none; border-radius:8px; font-size:18px;
  transition:0.3s;
}
.home-btn:hover { background:#16a085; }

/* EXPLORE */
#explore { display:flex; background:#f9f9f9; color:#333; }
.sidebar {
  width:320px; background:#fff; padding:20px; overflow-y:auto;
  box-shadow:2px 0 10px rgba(0,0,0,0.2);
}
.sidebar h2 { margin-top:0; font-size:22px; }
.sidebar h3 { margin-top:15px; font-size:18px; }
.sidebar button {
  width:100%; padding:10px; margin-bottom:8px;
  border:none; background:#3498db; color:white;
  cursor:pointer; border-radius:6px; font-size:16px;
  transition:0.3s;
}
.sidebar button:hover { background:#2980b9; }
#map { flex:1; }

/* Legend */
.legend {
  position:absolute; bottom:20px; right:20px;
  background:white; padding:10px; border-radius:6px;
  box-shadow:0 0 10px rgba(0,0,0,0.3); font-size:14px;
}

/* DASHBOARD */
#dashboard { padding:40px; background:#fff; color:#333; }
.back-btn {
  padding:10px 20px; background:#555; color:white;
  border:none; border-radius:6px; cursor:pointer;
}
.chart-container { width:80%; margin:auto; }
</style>
</head>
<body>

<!-- HOME -->
<div id="home" class="section active">
  <div id="globe"></div>
  <div class="home-overlay">
    <h1>Ubungo Municipal Web Atlas</h1>
    <p>Exploring environmental, climatic, and socio-economic patterns of Ubungo Municipality (2015â€“2025).</p>
    <a class="home-btn" onclick="showExplore()"><i class="fa fa-map"></i>&nbsp; Explore Maps</a>
    <a class="home-btn" onclick="showDashboard()"><i class="fa fa-chart-line"></i>&nbsp; Dashboard</a>
    <a class="home-btn" onclick="showAbout()"><i class="fa fa-info-circle"></i>&nbsp; About</a>
  </div>
</div>

<!-- EXPLORE -->
<div id="explore" class="section">
  <div class="sidebar">
    <h2>Explore Maps</h2>
    <h3><i class="fa fa-leaf"></i> Environment</h3>
    <button onclick="loadLayer('ndvi')">NDVI</button>
    <button onclick="loadLayer('landuse')">Land Use</button>
    <h3><i class="fa fa-cloud-rain"></i> Climate</h3>
    <button onclick="loadLayer('rainfall')">Rainfall</button>
    <button onclick="loadLayer('lst')">Land Surface Temp</button>
    <h3><i class="fa fa-city"></i> Socio-Economic</h3>
    <button onclick="loadLayer('population')">Population</button>
    <button onclick="loadLayer('roads')">Roads</button>
    <button class="back-btn" onclick="backHome()">Back Home</button>
  </div>
  <div id="map"></div>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="section">
  <button class="back-btn" onclick="backHome()">Back Home</button>
  <h2>Dashboard</h2>
  <div class="chart-container">
    <p>Interactive charts will appear here when you select a district.</p>
    <canvas id="ndviChart"></canvas>
  </div>
</div>

<!-- ABOUT -->
<div id="about" class="section">
  <button class="back-btn" onclick="backHome()">Back Home</button>
  <h2>About This Atlas</h2>
  <p>This atlas was developed to visualize environmental and socio-economic changes in Ubungo Municipality using GIS and remote sensing data. Data sources include rainfall records, NDVI indices, and census statistics.</p>
  <p><b>Credits:</b> Nicolas, [Institution], 2026</p>
</div>

<script>
// NAVIGATION
function showExplore(){ setActive('explore'); if(!window.map) initMap(); }
function showDashboard(){ setActive('dashboard'); }
function showAbout(){ setActive('about'); }
function backHome(){ setActive('home'); }
function setActive(id){ ['home','explore','dashboard','about'].forEach(s=>document.getElementById(s).classList.remove('active')); document.getElementById(id).classList.add('active'); }

// CESIUM GLOBE
Cesium.Ion.defaultAccessToken = 'YOUR_CESIUM_TOKEN'; // Replace with your token
const viewer = new Cesium.Viewer('globe',{animation:false,timeline:false,baseLayerPicker:false,geocoder:false,sceneModePicker:false});
Cesium.GeoJsonDataSource.load('data/UBUNGO_JSON.geojson',{stroke:Cesium.Color.YELLOW,fill:Cesium.Color.YELLOW.withAlpha(0.3),strokeWidth:3}).then(ds=>{
  viewer.dataSources.add(ds);
  setTimeout(()=>{ viewer.flyTo(ds,{duration:4}); },3000);
});
viewer.clock.onTick.addEventListener(()=>{ viewer.scene.camera.rotate(Cesium.Cartesian3.UNIT_Z,-0.00005); });

// LEAFLET MAP
function initMap(){
  window.map = L.map('map').setView([-6.78,39.23],11);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; OpenStreetMap contributors'}).addTo(window.map);
}
function loadLayer(type){
  if(window.currentLayer) window.map.removeLayer(window.currentLayer);
  fetch(`data/${type}.geojson`).then(r=>r.json()).then(data=>{
    window.currentLayer = L.geoJSON(data,{onEachFeature:(f,l)=>{l.bindPopup(`<b>${type.toUpperCase()}</b>`);}}).addTo(window.map);
    addLegend(type);
  });
}
function addLegend(type){
  if(window.legend) window.map.removeControl(window.legend);
  window.legend = L.control({position:'bottomright'});
  window.legend.onAdd = function(){
    var div = L.DomUtil.create('div','legend');
    div.innerHTML = `<b>${type.toUpperCase()} Legend</b><br>Colors and symbols here`;
    return div;
  };
  window.legend.addTo(window.map);
}
</script>
</body>
</html>
